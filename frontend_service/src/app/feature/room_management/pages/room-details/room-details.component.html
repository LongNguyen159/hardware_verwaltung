<app-title-bar
    [title]="roomName"
    [colorBackground]="true"
    [enableBackButton]="true"
>
</app-title-bar>
<div class="wrapper">
    <div>
        <mat-card style="width: 100%">
            <mat-card-header>
                <mat-card-title>
                    Details
                </mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <div *ngIf="allItemsOfRoom">
                    <p class="boldTitle"><strong>Device count: {{ allItemsOfRoom.length }} </strong></p>
                    
                    <table mat-table [dataSource]="allItemsOfRoom">
                        <!-- ID Column -->
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef>ID</th>
                            <td mat-cell *matCellDef="let item">{{ item.id }}</td>
                        </ng-container>
                
                        <!-- Item Name Column -->
                        <ng-container matColumnDef="item_name">
                            <th mat-header-cell *matHeaderCellDef>Item Name</th>
                            <td mat-cell *matCellDef="let item">{{ item.item_name }}</td>
                        </ng-container>
                
                        <!-- Description Column -->
                        <ng-container matColumnDef="description">
                            <th mat-header-cell *matHeaderCellDef>Description</th>
                            <td mat-cell *matCellDef="let item">{{ item.description }}</td>
                        </ng-container>
                
                        <!-- Annotation Column -->
                        <ng-container matColumnDef="annotation">
                            <th mat-header-cell *matHeaderCellDef>Annotation</th>
                            <td mat-cell *matCellDef="let item">{{ item.annotation }}</td>
                        </ng-container>
                
                        <!-- Location Column -->
                        <ng-container matColumnDef="location">
                            <th mat-header-cell *matHeaderCellDef>Location</th>
                            <td mat-cell *matCellDef="let item">{{ item.location }}</td>
                        </ng-container>
                
                        <!-- Borrowed By Column (if needed) -->
                        <ng-container matColumnDef="borrowed_by_user">
                            <th mat-header-cell *matHeaderCellDef>Borrowed By</th>
                            <td mat-cell *matCellDef="let item">
                                {{ item.borrowed_by_user_id ? item.user_name + ' (' + item.user_type + ')' : 'Not borrowed' }}
                            </td>
                        </ng-container>
                
                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    </table>
                    <mat-paginator #paginator [pageSizeOptions]="[10, 20, 30]" showFirstLastButtons></mat-paginator>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
    
    <div class="qr-code">
        <mat-card style="width: 100%">
            <mat-card-header>
                <mat-card-title>
                    QR Code
                </mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <div *ngIf="roomDetails">
                    <p class="boldTitle"><strong>QR Metadata:</strong></p>
                    <ul>
                        <li><strong class="boldTitle">id:</strong> {{ roomId }} </li>
                        <li><strong class="boldTitle">room_number:</strong> {{ roomDetails.room_number }} </li>
                        <!-- <li><strong>Borrowed since:</strong> 10 Aug. 2023</li> -->
                    </ul>
                </div>
                <div style="display: flex; justify-content: center;">
                    <img [src]="qrCodeDataUrl" alt="QR Code">
                </div>
            </mat-card-content>
            <mat-card-actions style="justify-content: center;">
                <button mat-button (click)="onDownloadClick()">Download QR Code</button>
            </mat-card-actions>
        </mat-card>
    </div>    
</div>
